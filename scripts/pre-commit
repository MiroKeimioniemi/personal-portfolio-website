#!/bin/bash

# Pre-commit hook: Post new blog posts to Bluesky and generate recent posts JSON
# 
# IMPORTANT: This file must be copied to .git/hooks/pre-commit to be active:
#   cp scripts/pre-commit .git/hooks/pre-commit
#   chmod +x .git/hooks/pre-commit
#
# After updating this file, remember to copy it again to .git/hooks/pre-commit

cd "$(git rev-parse --show-toplevel)" || exit 1

# Post new blog posts to Bluesky
./scripts/post-to-bluesky.sh

# Generate recent posts JSON file
node scripts/generate-recent-posts.js || exit 1

# Stage the generated JSON file
git add data/recent-posts.json 2>/dev/null || true
